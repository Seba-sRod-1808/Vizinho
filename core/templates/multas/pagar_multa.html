{% extends "base.html" %}

{% block title %}pagar multa{% endblock %}

{% block content %}
<div class="container-fluid" style="max-width: 700px;">
  <!-- Header -->
  <div class="mb-4 text-center">
    <h1 class="mb-1">
      <i class="bi bi-credit-card text-primary"></i>
      pagar multa
    </h1>
    <p class="text-muted mb-0" style="font-size: 0.875rem;">proceder al pago de la multa</p>
  </div>

  <!-- Detalles de la multa -->
  <div class="card mb-4">
    <div class="card-header bg-light">
      <i class="bi bi-file-text"></i> detalles de la multa
    </div>
    <div class="card-body">
      <div class="mb-3">
        <label class="text-muted mb-1" style="font-size: 0.8rem;">descripción</label>
        <p class="mb-0">{{ multa.descripcion }}</p>
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label class="text-muted mb-1" style="font-size: 0.8rem;">monto a pagar</label>
          <h3 class="mb-0 text-danger">Q{{ multa.monto|floatformat:2 }}</h3>
        </div>

        <div class="col-md-6">
          <label class="text-muted mb-1" style="font-size: 0.8rem;">fecha de emisión</label>
          <p class="mb-0">{{ multa.fecha|date:"d/m/Y" }}</p>
        </div>
      </div>
    </div>
  </div>

        <!-- Botones -->
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-success">
            <i class="bi bi-check-circle"></i> confirmar pago realizado
          </button>
          <a href="{% url 'lista_multas' %}" class="btn btn-outline-secondary">
            cancelar
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Info adicional -->
  <div class="card">
    <div class="card-body">
      <small class="text-muted d-block mb-2">
        <i class="bi bi-clock"></i> el pago será verificado por un administrador
      </small>
      <small class="text-muted d-block mb-2">
        <i class="bi bi-bell"></i> recibirás notificación cuando se confirme
      </small>
      <small class="text-muted d-block">
        <i class="bi bi-hourglass"></i> el proceso de verificación toma de 24 a 48 horas
      </small>
    </div>
  </div>
</div>

<script>
function previewComprobante(event) {
  const input = event.target;
  const preview = document.getElementById('preview');
  const container = document.getElementById('preview-container');
  
  if (input.files && input.files[0]) {
    const file = input.files[0];
    
    if (file.size > 5 * 1024 * 1024) {
      alert('el archivo es muy grande. máximo 5MB');
      input.value = '';
      return;
    }
    
    // Si es PDF, no mostrar preview
    if (file.type === 'application/pdf') {
      container.innerHTML = '<p class="text-success"><i class="bi bi-file-pdf"></i> PDF seleccionado: ' + file.name + '</p>';
      container.style.display = 'block';
      return;
    }
    
    // Si es imagen, mostrar preview
    const reader = new FileReader();
    reader.onload = function(e) {
      preview.src = e.target.result;
      container.style.display = 'block';
    }
    reader.readAsDataURL(file);
  }
}
</script>
{% endblock %}